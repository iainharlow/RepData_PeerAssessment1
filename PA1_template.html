<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Reproducible Research: Peer Assessment 1</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h2>Reproducible Research: Peer Assessment 1</h2>

<h1></h1>

<p>A quick note: Please be aware that this (and other submissions) may end up with slightly different plots and conclusions to your own. This is because the instructions are not wholly unambiguous. For example, <a href="https://class.coursera.org/repdata-008/forum/thread?thread_id=55">there is some debate</a> over what is meant by &ldquo;ignoring&rdquo; NAs in this assignment - I have taken it to mean removing NAs (na.rm=TRUE) when computing means/sums in the first part, in order to compare this approach with the later imputation method. But both are - statistically speaking - pretty terrible ideas with the NAs distributed as they are here, so if you come across someone who instead removes all the NAs in advance for part 1 - a much more justifiable approach, albeit not what I think the instructions strictly ask us to do - I would suggest not downgrading for that. </p>

<p>Figure 4 - the panel plot - will be different depending on the system it&#39;s constructed in (I used ggplot, the example is lattice) and whether the panels are stacked or presented side-by-side. The example plot, and mine, shows them stacked, which better displays the differences in relative activity distribution. Others may instead choose to display them side-by-side to allow easier comparison of absolute step rates; I think that&#39;s a legitimate choice. </p>

<p>I&#39;ve generally scaled steps to show &ldquo;Mean steps per <em>minute</em>&rdquo;, rather than total steps, or steps per 5-minute-interval, because that seems to me to be a more meaningful and generalisable statistic.</p>

<p>I&#39;ve also used inline R script to answer some of the specific questions. That is, I&#39;ve calculated a statistic such as mean daily steps, then called it in a non-code section (within a sentence). This is instead of printing the value to the console from the code sections, as others may have done.</p>

<h1></h1>

<h3>Loading and Processing the data</h3>

<p>Load useful libraries (loading text suppressed for clarity):</p>

<pre><code class="r">suppressMessages(library(plyr)) # For working with tidy data frames
suppressMessages(library(dplyr)) # For working with tidy data frames
suppressMessages(library(scales)) # For plotting 
suppressMessages(library(ggplot2)) # For plotting
</code></pre>

<p>Clear and set workspace, load the data:</p>

<pre><code class="r">rm(list = ls())
wd&lt;-&quot;C:/Users/Iain/Documents/GitHub/RepData_PeerAssessment1&quot;
filename&lt;-&quot;/activity.csv&quot;
setwd(wd)
df&lt;-read.csv(paste(wd,filename,sep=&quot;&quot;))
</code></pre>

<p>Format the date/interval variables and prepare for dplyr:</p>

<pre><code class="r">hours&lt;-df$interval %/% 100
mins&lt;-df$interval %% 100
time&lt;-hours+mins/60 # Convert to hours. Never actually used, since this gets converted to a factor anyhow, but this labelling is less confusing for me when visually inspecting the data!
df$timefactor&lt;-as.factor(time) # Store the time as a factor for analysis
tidydf&lt;-tbl_df(df) # Creates tidy data frame for use with dplyr
</code></pre>

<p>Glance at the formatted tidy data frame:</p>

<pre><code class="r">head(tidydf)
</code></pre>

<pre><code>## Source: local data frame [6 x 4]
## 
##   steps       date interval         timefactor
## 1    NA 2012-10-01        0                  0
## 2    NA 2012-10-01        5 0.0833333333333333
## 3    NA 2012-10-01       10  0.166666666666667
## 4    NA 2012-10-01       15               0.25
## 5    NA 2012-10-01       20  0.333333333333333
## 6    NA 2012-10-01       25  0.416666666666667
</code></pre>

<h1></h1>

<h3>What is the mean total number of steps taken per day?</h3>

<p>R code to generate required plot and variables:</p>

<pre><code class="r">grouped_table &lt;- group_by(tidydf[1:2],date) # Group steps by date
plot1_data &lt;- summarise_each(grouped_table,funs(sum(., na.rm=TRUE))) # Total steps per day

#Create histogram using ggplot2 package, choosing pretty bin size:
xbreaks &lt;- pretty(range(plot1_data$steps,na.rm=TRUE),25)
fig1 &lt;- qplot(steps,data=plot1_data,breaks=xbreaks) 

fig1 &lt;- fig1 + labs(title = &quot;Histogram of Total Daily Steps&quot;) #Adjust plot
fig1 &lt;- fig1 + labs(x = &quot;Total number of steps&quot;)
fig1 &lt;- fig1 + labs(y = &quot;Number of days&quot;)
fig1 &lt;- fig1 + theme(axis.title.x = element_text(vjust=-0.35),
     axis.title.y = element_text(vjust=0.5),
     plot.title = element_text(vjust=2))

meansteps &lt;- mean(plot1_data$steps,na.rm=TRUE) # Calculate mean daily steps
mediansteps &lt;- median(plot1_data$steps,na.rm=TRUE) # Calculate median daily steps

meansteps_nice &lt;- sprintf(&quot;%.1f&quot;, meansteps) # For nicer printing, create 
# formatted string for the mean value with 1 decimal place.
</code></pre>

<p>Histogram of total daily steps:</p>

<pre><code class="r">print(fig1) # Print out Histogram of Total Daily Steps:
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/> </p>

<p>Using inline R script to print variables directly:  </p>

<p>The mean number of daily steps is 9354.2.<br/>
The median number of daily steps is 10395.</p>

<h1></h1>

<h3>What is the average daily activity pattern?</h3>

<p>R code to generate required plot and variables:</p>

<pre><code class="r">grouped_table &lt;- group_by(tidydf[c(1,4)],timefactor) # Group steps by time factor
plot2_data &lt;- summarise_each(grouped_table,funs(mean(., na.rm = TRUE))) # Mean steps per interval
plot2_data$time &lt;- ISOdate(2001, 1, 1, 0, tz = &quot;GMT&quot;) + as.numeric(plot2_data$timefactor)*5*60 # Factor no good for labeling x-axis, so generate a POSIXct object

# Create histogram using ggplot2 package:
fig2 &lt;- qplot(time,steps/5,data=plot2_data,geom=&quot;line&quot;)
# Note conversion to steps per minute for easier comparison with other data

fig2 &lt;- fig2 + labs(title = &quot;Average Daily Activity Pattern&quot;) #Adjust plot
fig2 &lt;- fig2 + labs(x = &quot;Time of Day&quot;)
fig2 &lt;- fig2 + labs(y = &quot;Mean Steps per minute&quot;)
fig2 &lt;- fig2 + theme(axis.title.x = element_text(vjust=-0.35),
     axis.title.y = element_text(vjust=1),
     plot.title = element_text(vjust=2))
fig2 &lt;- fig2 + scale_x_datetime(breaks = date_breaks(&quot;4 hour&quot;),
                                labels = date_format(&quot;%H:%M&quot;))

max_steprate_nice &lt;- sprintf(&quot;%.1f&quot;, max(plot2_data$steps)/5)
max_interval_start &lt;- strftime(plot2_data$time[which.max(plot2_data$steps)],format=&quot;%H:%M&quot;,tz=&quot;GMT&quot;)
max_interval_end &lt;- strftime(plot2_data$time[which.max(plot2_data$steps)+1],format=&quot;%H:%M&quot;,tz=&quot;GMT&quot;)
</code></pre>

<p>Average daily activity pattern:</p>

<pre><code class="r">print(fig2) # Print out Time Series of average steps per minute:
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/> </p>

<p>The interval with the greatest number of daily steps is between 08:40 and 08:45, with a mean step rate of 41.2 steps per minute. </p>

<p>Now technically the question asks for greatest total number of steps, which missing values might cause to differ from the (more meaningful!) greatest step rate. So quickly check it:</p>

<pre><code class="r">plot2_check &lt;- summarise_each(grouped_table,funs(sum(., na.rm = TRUE))) # Total steps per interval
max_steptotal &lt;- max(plot2_check$steps,na.rm=TRUE)
maxtotal_interval_start &lt;- strftime(plot2_data$time[which.max(plot2_check$steps)],format=&quot;%H:%M&quot;,tz=&quot;GMT&quot;)
maxtotal_interval_end &lt;- strftime(plot2_data$time[which.max(plot2_check$steps)+1],format=&quot;%H:%M&quot;,tz=&quot;GMT&quot;)
</code></pre>

<p>The interval between 08:40 and 08:45 included the greatest total number of steps: 10927.</p>

<h1></h1>

<h3>Imputing missing values</h3>

<p>R code to count NAs:</p>

<pre><code class="r">num_NAs &lt;- sum(is.na(df$steps))
</code></pre>

<p>The total number of missing step values is 2304.</p>

<p>R code to impute new NAs. Overall we are adopting an approach similar to that of <a href="http://en.wikipedia.org/wiki/Imputation_(statistics)" title="mean imputation">mean imputation</a>, but to reintroduce some of the variance that loses we&#39;re going to randomly generate the data from a distribution around the mean that we choose (specifically, we&#39;ll use poisson):</p>

<pre><code class="r"># Logic: Steps in any given interval is an integer &gt;=0, so a poisson distribution
# seems a fair way of imputing new data (of course the reality is more 
# complicated, with a greater number of zeros, but we&#39;re staying simple).
# We already have average step rates for each interval, across days. It might be 
# nice to construct a smoothed version of the step data to get local averages
# (i.e. the average steps taken in preceding/following intervals) - but visual
# inspection shows NAs occur in large clusters, so neighbouring data won&#39;t be
# much help. Finally, we&#39;d also like to use a modifier based on the activity in
# that whole day, so that NA values are affected by the day they occur, as well 
# as the time - but our visual inspection also reveals that days tend to have 
# have full data or no data at all so that approach won&#39;t buy us anything either.
# So we&#39;ll keep it simple and just use the interval mean. 

tidydf$intervalmean &lt;- plot2_data$steps[tidydf$timefactor] 
# Mean steps associated with each interval, mapped to each observation

tidydf$imputed &lt;- rpois(nrow(tidydf),tidydf$intervalmean)
# Generate poisson distributed data for every row

tidydf$imputed[!is.na(tidydf$steps)] &lt;- tidydf$steps[!is.na(tidydf$steps)]
# Replace this imputed data with the original if it exists (done this way to
# avoid writing over the true data in $steps). We now have the new dataset...

dfnew&lt;-tidydf[c(6,2,3,4)] #...with $imputed replacing $steps:

summary(dfnew)
</code></pre>

<pre><code>##     imputed               date          interval     
##  Min.   :  0.00   2012-10-01:  288   Min.   :   0.0  
##  1st Qu.:  0.00   2012-10-02:  288   1st Qu.: 588.8  
##  Median :  0.00   2012-10-03:  288   Median :1177.5  
##  Mean   : 37.36   2012-10-04:  288   Mean   :1177.5  
##  3rd Qu.: 27.00   2012-10-05:  288   3rd Qu.:1766.2  
##  Max.   :806.00   2012-10-06:  288   Max.   :2355.0  
##                   (Other)   :15840                   
##               timefactor   
##  0                 :   61  
##  0.0833333333333333:   61  
##  0.166666666666667 :   61  
##  0.25              :   61  
##  0.333333333333333 :   61  
##  0.416666666666667 :   61  
##  (Other)           :17202
</code></pre>

<p>Now, if we repeat the histogram/mean/median calculation from earlier:</p>

<pre><code class="r">grouped_table &lt;- group_by(dfnew[1:2],date) # Group steps by date
plot3_data &lt;- summarise_each(grouped_table,funs(sum(., na.rm=TRUE))) # Total steps per day

#Create histogram using ggplot2 package, choosing pretty bin size:
xbreaks &lt;- pretty(range(plot3_data$imputed,na.rm=TRUE),25)
fig3 &lt;- qplot(imputed,data=plot3_data,breaks=xbreaks) 

fig3 &lt;- fig3 + labs(title = &quot;Histogram of Total Daily Steps&quot;) #Adjust plot
fig3 &lt;- fig3 + labs(x = &quot;Total number of steps&quot;)
fig3 &lt;- fig3 + labs(y = &quot;Number of days&quot;)
fig3 &lt;- fig3 + theme(axis.title.x = element_text(vjust=-0.35),
     axis.title.y = element_text(vjust=0.5),
     plot.title = element_text(vjust=2))

meansteps &lt;- mean(plot3_data$imputed,na.rm=TRUE) # Calculate mean daily steps
mediansteps &lt;- median(plot3_data$imputed,na.rm=TRUE) # Calculate median daily steps

meansteps_nice &lt;- sprintf(&quot;%.1f&quot;, meansteps) # For nicer printing, create 
# formatted string for the mean value with 1 decimal place.
</code></pre>

<p>Histogram of total daily steps (after NAs imputed with new data):</p>

<pre><code class="r">print(fig3) # Print out Histogram of Total Daily Steps:
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-13"/> </p>

<p>The mean number of daily steps is 10759.5.<br/>
The median number of daily steps is 10754.</p>

<p>We can see that the mean has moved higher, very close to the median. The histogram shows us why. When we originally discarded the NA values from the analysis, that meant we ended up with some days (8 in fact) that had a total step count of zero, and that dragged the mean (but not the median) down. But what was actually going on is that these days had all or nearly all missing values, not zeros. So, when we imputed new estimates for these missing values, based on the interval averages we saw <em>elsewhere</em> in the dataset, they ended up giving each of those days a new nonzero number of steps - and you can see 8 days have shifted from the 0 bin in the histogram to the average bin. </p>

<p>Note too, that this highlights a limitation of the imputation procedure (actually the data): Because we have no information about how active these 8 days were compared to the others (we only used interval means remember, as the missing value pattern precluded using local or daily means), we ended up giving each of the days a number of steps very close to the global mean. In other words, we haven&#39;t accounted for any of the between-day variance. </p>

<p>Now, if there were some more intervals available on each of those days, we could compute daily step rates based on the the step rate <em>within those intervals</em>, taking into account the average rate in that interval. With a decent number of non-NA intervals in each day this imputation procedure would become much more accurate than simply using the mean interval procedure alone. But we simply don&#39;t have sufficient data for that, so the best procedure would actually be to remove the 8 days with missing data I should think. I leave this imperfect imputation as is, since it illustrates the limitations of the data set quite well. But don&#39;t do this in real life! Imputation only works better than discarding if you can infer sufficient information about the values you are imputing, and the structure of the data sometimes precludes this (as in this case). And of course it can be much worse if you use an overly simple method like we have, and fail to take some sources of variance into account. It&#39;s clear from the histograms that we&#39;ve ended up artificially reducing the variance of our data. </p>

<h1></h1>

<h3>Differences in activity patterns between weekdays and weekends</h3>

<p>Let&#39;s construct a new factor variable in our data frame:</p>

<pre><code class="r">#Get the day name for each observation:
days &lt;- weekdays(as.Date(dfnew$date))

# Create day factor variable, initially set all values to &quot;Weekday&quot;:
dfnew$dayfactor &lt;- rep(&quot;Weekday&quot;,nrow(dfnew))

# Change Saturdays and Sundays to &quot;Weekend&quot; and convert to factor:
dfnew$dayfactor[days==&quot;Saturday&quot;|days==&quot;Sunday&quot;] &lt;- &quot;Weekend&quot;
dfnew$dayfactor &lt;- as.factor(dfnew$dayfactor)

# Check we have roughly the right proportions of each factor:
levels(dfnew$dayfactor)
</code></pre>

<pre><code>## [1] &quot;Weekday&quot; &quot;Weekend&quot;
</code></pre>

<pre><code class="r">summary(dfnew$dayfactor)
</code></pre>

<pre><code>## Weekday Weekend 
##   12960    4608
</code></pre>

<p>Create new daily activity pattern plots, this time separately for Weekdays/Weekends:</p>

<pre><code class="r">grouped_table &lt;- group_by(dfnew[,c(1,4,5)],timefactor,dayfactor) # Group steps by time and day factors
plot4_data &lt;- summarise_each(grouped_table,funs(mean)) # Mean steps per interval/day combination

plot4_data$time &lt;- ISOdate(2001, 1, 1, 0, tz = &quot;GMT&quot;) + as.numeric(plot4_data$timefactor)*5*60 # Factor no good for labeling x-axis, so generate a POSIXct object

# Create histogram using ggplot2 package:
fig4 &lt;- qplot(time,imputed/5,data=plot4_data,geom=&quot;line&quot;,facets= dayfactor~.)
# Note conversion to steps per minute for easier comparison with other data

fig4 &lt;- fig4 + labs(title = &quot;Daily Activity Pattern: Weekdays vs Weekends&quot;) #Adjust plot
fig4 &lt;- fig4 + labs(x = &quot;Time of Day&quot;)
fig4 &lt;- fig4 + labs(y = &quot;Mean Steps per minute&quot;)
fig4 &lt;- fig4 + theme(axis.title.x = element_text(vjust=-0.35),
     axis.title.y = element_text(vjust=1),
     plot.title = element_text(vjust=2))
fig4 &lt;- fig4 + scale_x_datetime(breaks = date_breaks(&quot;4 hour&quot;),
                                labels = date_format(&quot;%H:%M&quot;))
</code></pre>

<p>Time series showing Daily Activity Pattern for Weekdays vs Weekends (after NAs imputed with new data):</p>

<pre><code class="r">print(fig4) # Print out Daily Activity Patterns for Weekdays/Weekends
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-16"/> </p>

<p>The plots are presented stacked for comparison of activity distributions. From this, it&#39;s immediately clear that:</p>

<ul>
<li>Activity begins later on weekends, generally around 8am instead of 6am. Lie in!</li>
<li>Activity ends later too, some weekends this person is up past 9pm! Crazy!</li>
<li>The peak at 8.40am is smaller in the weekend data, but it&#39;s still there: So if it&#39;s a commute then either this person is working some weekends, or they have some other regular morning activity (jogging for example).</li>
<li>There&#39;s a peak around 7pm in the weekday plot that&#39;s not present at weekends, so perhaps that is the commute home. That is a long workday, but the absence of a single peak like we see for the morning hints that they may sometimes go home earlier (e.g. at 4pm and 6pm).<br/></li>
<li>Activity generally appears to be much more homogenous during weekends, i.e. mean step rates are sustained throughout the day, and less concentrated in the mornings. Be careful though, since we&#39;re looking at averaged data. It may simply be that weekdays are more predictable, i.e. the peaks and troughs occur at the same time each day and thus show up on the average plot. Activity could be just as &#39;spiky&#39; during the weekends, but if it&#39;s less tightly scheduled the averaging would smooth it out. So we can&#39;t actually say too much about the distribution of activity across time without also plotting a measure of variance across days.</li>
</ul>

<p>This concludes our tour through this dataset. I hope you enjoyed reading about these two separate terrible approaches to dealing with missing data.</p>

</body>

</html>
